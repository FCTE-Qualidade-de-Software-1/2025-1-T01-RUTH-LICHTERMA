<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Q-Rapid Dashboard - AgroMart</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }
        
        .header h1 {
            color: #333;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            color: #666;
            font-size: 1.2em;
        }
        
        .metrics-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .metric-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border-left: 5px solid #667eea;
            transition: transform 0.3s ease;
        }
        
        .metric-card:hover {
            transform: translateY(-5px);
        }
        
        .metric-title {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .metric-value {
            font-size: 2.5em;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }
        
        .metric-status {
            font-size: 0.9em;
            padding: 5px 10px;
            border-radius: 20px;
            display: inline-block;
        }
        
        .status-good {
            background: #d4edda;
            color: #155724;
        }
        
        .status-warning {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-poor {
            background: #f8d7da;
            color: #721c24;
        }
        
        .charts-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .chart-container {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        
        .chart-title {
            font-size: 1.3em;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .full-width {
            grid-column: 1 / -1;
        }
        
        .legend {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .legend h3 {
            color: #333;
            margin-bottom: 15px;
        }
        
        .legend-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            padding: 10px;
            background: white;
            border-radius: 8px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 10px;
        }
        
        @media (max-width: 768px) {
            .charts-section {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .metric-value {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ Q-Rapid Dashboard</h1>
            <p>Monitoramento de Qualidade do Software AgroMart</p>
            <p><small>√öltima atualiza√ß√£o: <span id="lastUpdate"></span></small></p>
        </div>
        
        <div class="metrics-overview" id="metricsOverview">
            <!-- Cards de m√©tricas ser√£o inseridos aqui pelo JavaScript -->
        </div>
        
        <div class="charts-section">
            <div class="chart-container">
                <div class="chart-title">üìä Adequa√ß√£o Funcional</div>
                <canvas id="functionalChart"></canvas>
            </div>
            
            <div class="chart-container">
                <div class="chart-title">üé® M√©tricas de Usabilidade</div>
                <canvas id="usabilityChart"></canvas>
            </div>
            
            <div class="chart-container full-width">
                <div class="chart-title">üìà Evolu√ß√£o das M√©tricas Cr√≠ticas</div>
                <canvas id="timelineChart"></canvas>
            </div>
        </div>
        
        <div class="legend">
            <h3>üìã Legenda das M√©tricas</h3>
            <div class="legend-grid" id="legendGrid">
                <!-- Legenda ser√° gerada dinamicamente -->
            </div>
        </div>
    </div>

    <script>
        // Carregar dados das m√©tricas
        async function loadMetricsData() {
            try {
                const response = await fetch('./data/metrics_data.json');
                if (!response.ok) {
                    throw new Error('Dados n√£o encontrados');
                }
                const data = await response.json();
                // Retorna o √∫ltimo item do array (dados mais recentes)
                return Array.isArray(data) ? data[data.length - 1] : data;
            } catch (error) {
                console.warn('Usando dados simulados:', error);
                // Dados simulados baseados na avalia√ß√£o de usabilidade
                return {
                    "date": "2025-07-05",
                    "M1_completude_funcional": 78.0,
                    "M2_sucesso_tarefas": 82.0,
                    "M3_autonomia_usuario": 70.0,
                    "M4_navegacao_sucesso": 75.0,
                    "M5_compreensao_csa": 85.0,
                    "M6_consistencia_dispositivos": 88.0,
                    "M7_legibilidade_mensagens": 40.0,
                    "M8_descoberta_carrossel": 30.0,
                    "M9_compreensao_nomenclatura": 60.0,
                    "M10_reconhecimento_icones": 50.0,
                    "M11_prevencao_erros": 20.0,
                    "M12_contraste_visual": 45.0,
                    "M13_tempo_aprendizado": 25.0
                };
            }
        }

        // Configura√ß√£o das m√©tricas
        const metricNames = {
            M1_completude_funcional: { name: "Completude Funcional", unit: "%", target: 85, color: "#36A2EB" },
            M2_sucesso_tarefas: { name: "Sucesso em Tarefas", unit: "%", target: 90, color: "#FF6384" },
            M3_autonomia_usuario: { name: "Autonomia do Usu√°rio", unit: "%", target: 80, color: "#4BC0C0" },
            M4_navegacao_sucesso: { name: "Navega√ß√£o Bem-sucedida", unit: "%", target: 90, color: "#FFCE56" },
            M5_compreensao_csa: { name: "Compreens√£o CSA", unit: "%", target: 80, color: "#9966FF" },
            M6_consistencia_dispositivos: { name: "Consist√™ncia Dispositivos", unit: "%", target: 90, color: "#FF9F40" },
            M7_legibilidade_mensagens: { name: "Legibilidade Mensagens", unit: "%", target: 90, color: "#FF6B6B" },
            M8_descoberta_carrossel: { name: "Descoberta Carrossel", unit: "%", target: 85, color: "#4ECDC4" },
            M9_compreensao_nomenclatura: { name: "Compreens√£o Nomenclatura", unit: "%", target: 95, color: "#45B7D1" },
            M10_reconhecimento_icones: { name: "Reconhecimento √çcones", unit: "%", target: 85, color: "#96CEB4" },
            M11_prevencao_erros: { name: "Preven√ß√£o de Erros", unit: "%", target: 80, color: "#FFEAA7" },
            M12_contraste_visual: { name: "Contraste Visual", unit: "%", target: 95, color: "#DDA0DD" },
            M13_tempo_aprendizado: { name: "Tempo Aprendizado", unit: "min", target: 15, invert: true, color: "#F39C12" }
        };

        // Fun√ß√£o para determinar o status da m√©trica
        function getMetricStatus(value, target, invert = false) {
            if (invert) {
                return value <= target ? 'good' : value <= target * 1.2 ? 'warning' : 'poor';
            } else {
                return value >= target ? 'good' : value >= target * 0.8 ? 'warning' : 'poor';
            }
        }

        // Fun√ß√£o para criar cards de m√©tricas
        function createMetricCards(data) {
            const container = document.getElementById('metricsOverview');
            container.innerHTML = '';
            
            Object.keys(metricNames).forEach(key => {
                const metric = metricNames[key];
                const value = data[key];
                if (value === undefined) return;
                
                const status = getMetricStatus(value, metric.target, metric.invert);
                
                const card = document.createElement('div');
                card.className = 'metric-card';
                card.innerHTML = `
                    <div class="metric-title">${metric.name}</div>
                    <div class="metric-value">${value}${metric.unit}</div>
                    <div class="metric-status status-${status}">
                        ${status === 'good' ? '‚úÖ Meta Atingida' : 
                          status === 'warning' ? '‚ö†Ô∏è Aten√ß√£o' : '‚ùå Cr√≠tico'}
                    </div>
                    <small style="color: #666;">Meta: ${metric.target}${metric.unit}</small>
                `;
                container.appendChild(card);
            });
        }

        // Fun√ß√£o para criar gr√°fico de adequa√ß√£o funcional
        function createFunctionalChart(data) {
            const ctx = document.getElementById('functionalChart').getContext('2d');
            
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Completude Funcional', 'Sucesso em Tarefas', 'Autonomia do Usu√°rio'],
                    datasets: [{
                        data: [
                            data.M1_completude_funcional || 0,
                            data.M2_sucesso_tarefas || 0,
                            data.M3_autonomia_usuario || 0
                        ],
                        backgroundColor: ['#36A2EB', '#FF6384', '#4BC0C0'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // Fun√ß√£o para criar gr√°fico de usabilidade
        function createUsabilityChart(data) {
            const ctx = document.getElementById('usabilityChart').getContext('2d');
            
            new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: [
                        'Legibilidade',
                        'Carrossel',
                        'Nomenclatura', 
                        '√çcones',
                        'Preven√ß√£o Erros',
                        'Contraste'
                    ],
                    datasets: [{
                        label: 'Valores Atuais',
                        data: [
                            data.M7_legibilidade_mensagens || 0,
                            data.M8_descoberta_carrossel || 0,
                            data.M9_compreensao_nomenclatura || 0,
                            data.M10_reconhecimento_icones || 0,
                            data.M11_prevencao_erros || 0,
                            data.M12_contraste_visual || 0
                        ],
                        backgroundColor: 'rgba(102, 126, 234, 0.2)',
                        borderColor: '#667eea',
                        borderWidth: 2,
                        pointBackgroundColor: '#667eea'
                    }, {
                        label: 'Metas',
                        data: [90, 85, 95, 85, 80, 95],
                        backgroundColor: 'rgba(255, 99, 132, 0.1)',
                        borderColor: '#ff6384',
                        borderWidth: 1,
                        pointBackgroundColor: '#ff6384'
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        }

        // Fun√ß√£o para criar gr√°fico de evolu√ß√£o temporal
        function createTimelineChart(data) {
            const ctx = document.getElementById('timelineChart').getContext('2d');
            
            // Simular evolu√ß√£o temporal das m√©tricas cr√≠ticas
            const dates = ['01/06', '15/06', '01/07', '05/07'];
            const criticalMetrics = [
                'M7_legibilidade_mensagens', 
                'M8_descoberta_carrossel', 
                'M11_prevencao_erros', 
                'M12_contraste_visual'
            ];
            
            const datasets = criticalMetrics.map(key => {
                const metric = metricNames[key];
                const currentValue = data[key] || 0;
                
                return {
                    label: metric.name,
                    data: [
                        Math.max(0, currentValue - 10),
                        Math.max(0, currentValue - 7), 
                        Math.max(0, currentValue - 3),
                        currentValue
                    ],
                    borderColor: metric.color,
                    backgroundColor: metric.color + '20',
                    tension: 0.4,
                    fill: false
                };
            });

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: dates,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        }

        // Fun√ß√£o para criar legenda
        function createLegend() {
            const container = document.getElementById('legendGrid');
            container.innerHTML = '';
            
            Object.keys(metricNames).forEach(key => {
                const metric = metricNames[key];
                const item = document.createElement('div');
                item.className = 'legend-item';
                item.innerHTML = `
                    <div class="legend-color" style="background: ${metric.color};"></div>
                    <span><strong>${key.replace('_', ' ').toUpperCase()}:</strong> ${metric.name}</span>
                `;
                container.appendChild(item);
            });
        }

        // Fun√ß√£o para atualizar timestamp
        function updateTimestamp() {
            document.getElementById('lastUpdate').textContent = 
                new Date().toLocaleString('pt-BR');
        }

        // Inicializar dashboard
        document.addEventListener('DOMContentLoaded', async function() {
            updateTimestamp();
            
            try {
                const data = await loadMetricsData();
                console.log('Dados carregados:', data);
                createMetricCards(data);
                createFunctionalChart(data);
                createUsabilityChart(data);
                createTimelineChart(data);
                createLegend();
            } catch (error) {
                console.error('Erro ao carregar dashboard:', error);
                // Mesmo em caso de erro, tenta mostrar os dados simulados
                const fallbackData = {
                    "date": "2025-07-05",
                    "M1_completude_funcional": 78.0,
                    "M2_sucesso_tarefas": 82.0,
                    "M3_autonomia_usuario": 70.0,
                    "M7_legibilidade_mensagens": 40.0,
                    "M8_descoberta_carrossel": 30.0,
                    "M9_compreensao_nomenclatura": 60.0,
                    "M10_reconhecimento_icones": 50.0,
                    "M11_prevencao_erros": 20.0,
                    "M12_contraste_visual": 45.0
                };
                createMetricCards(fallbackData);
                createFunctionalChart(fallbackData);
                createUsabilityChart(fallbackData);
                createTimelineChart(fallbackData);
                createLegend();
            }
        });
    </script>
</body>
</html>
